import{d as k,p as B,O as A,v as b,x as E,f as d,w as t,c as S,e as s,b as u,B as U,R as y,n as i,a as C,o as l,E as n,_ as N}from"./index-JbcahPOn.js";const w=["src"],z=k({__name:"Upload",props:["modelValue"],emits:["update:modelValue"],setup(r,{emit:m}){const c=m,a=B(!1),p={Authorization:`Bearer ${A().getAdminInfo()?.token}`},f=(e,o)=>{console.log("图片上传成功回调",e,o),c("update:modelValue",e.data),a.value=!1},_=(e,o)=>{console.log("图片上传失败回调",e,o),c("update:modelValue",""),a.value=!1,n.error("上传失败")},v=e=>{if(a.value=!0,console.log("图片上传前回调",e),e.type.startsWith("image/")){if(e.size/1024/1024>20)return n.error("图片大小不能超过 20MB!"),a.value=!1,!1}else return n.error("只能上传图片!"),a.value=!1,!1;return!0};return(e,o)=>{const g=s("el-text"),x=s("el-icon"),V=s("el-upload"),h=E("loading");return b((l(),d(V,{class:"avatar-uploader",action:"/api/upload",headers:p,drag:"","show-file-list":!1,"on-success":f,"on-error":_,"before-upload":v,"element-loading-background":"rgba(255, 255, 255, 1)","element-loading-text":"正在上传中..."},{default:t(()=>[r.modelValue?(l(),S("img",{key:0,src:r.modelValue,class:"avatar"},null,8,w)):(l(),d(x,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[u(U(y)),u(g,{class:"mx-1"},{default:t(()=>[...o[0]||(o[0]=[i("点击上传或",-1),C("strong",null,"拖拽",-1),i("到此处上传",-1)])]),_:1})]),_:1}))]),_:1})),[[h,a.value]])}}}),M=N(z,[["__scopeId","data-v-6e50810f"]]);export{M as U};
