import{d as R,q as _,s as $,x as z,y as I,c as M,a as y,b as t,B as q,e as r,w as o,C as m,P as K,G as c,o as s,t as b,f as x,D as C,Q as U,R as F,p as f,N as k,S as G,_ as O}from"./index-C4-hAADe.js";import{g as P,d as Q}from"./index-Cjipnnz7.js";import{S as W}from"./index-9ecMcTsN.js";import"./request-Cv4ySAHf.js";import"./utils-mNzDqqKl.js";import"./dayjs-CaYfQCQj.js";const j={class:"article-manager","element-loading-background":"rgba(255, 255, 255, 1)","element-loading-text":"正在全力加载中..."},H={class:"function"},J={class:"right-controls"},X=R({__name:"index",setup(Y){const w=_([]),n=_(!1),d=_({page:1,pageSize:1e3,sortType:W.VIEW_COUNT_DESC,searchContent:""}),p=async()=>{n.value=!0;try{const l=await P(d.value);l.code===1?w.value=l.data.rows||[]:c.error(l.message||"获取文章列表失败")}catch(l){c.error("获取文章列表失败"),console.error(l)}finally{n.value=!1}},h=()=>{d.value.page=1,p()},T=()=>{d.value.searchContent="",d.value.page=1,p()},B=()=>{k.push("/dashboard/article/edit")},V=l=>{k.push({path:"/dashboard/article/edit",query:{id:l?.id}})},S=l=>{G.confirm("确定删除该文章吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{n.value=!0;try{const e=await Q(l.id);e.code===1?(c.success("删除成功"),await p()):c.error(e.message||"删除失败")}catch(e){c.error("删除失败"),console.error(e)}finally{n.value=!1}}).catch(()=>{c.info("已取消删除")})};return $(async()=>{n.value=!0,await p(),n.value=!1}),(l,e)=>{const A=r("el-input"),u=r("el-button"),i=r("el-table-column"),v=r("el-text"),g=r("RouterLink"),D=r("el-table"),E=r("el-card"),N=I("loading");return z((f(),M("div",j,[y("div",H,[y("div",J,[t(A,{modelValue:d.value.searchContent,"onUpdate:modelValue":e[0]||(e[0]=a=>d.value.searchContent=a),style:{width:"240px"},placeholder:"搜索关键词",clearable:"",onKeydown:q(h,["enter"])},null,8,["modelValue"]),t(u,{style:{margin:"0 8px"},plain:"",type:"primary",onClick:h},{default:o(()=>[...e[1]||(e[1]=[s(" 搜索 ",-1)])]),_:1}),t(u,{plain:"",onClick:T},{default:o(()=>[...e[2]||(e[2]=[s("重置",-1)])]),_:1}),t(u,{type:"success",onClick:B,icon:m(K)},{default:o(()=>[...e[3]||(e[3]=[s("新增文章",-1)])]),_:1},8,["icon"])])]),t(E,{style:{"margin-top":"16px"}},{default:o(()=>[t(D,{data:w.value,loading:n.value,stripe:"",style:{width:"100%"}},{default:o(()=>[t(i,{type:"index",label:"序号",width:"60"}),t(i,{prop:"title",label:"标题","min-width":"150","show-overflow-tooltip":""},{default:o(a=>[t(g,{to:`/article/detail?id=${a.row.id}`,style:{"text-decoration":"none"}},{default:o(()=>[t(v,null,{default:o(()=>[s(b(a.row.title),1)]),_:2},1024)]),_:2},1032,["to"])]),_:1}),t(i,{prop:"subTitle",label:"副标题","min-width":"120","show-overflow-tooltip":""},{default:o(a=>[t(g,{to:`/article/detail?id=${a.row.id}`,style:{"text-decoration":"none"}},{default:o(()=>[t(v,null,{default:o(()=>[s(b(a.row.subTitle),1)]),_:2},1024)]),_:2},1032,["to"])]),_:1}),t(i,{prop:"viewCount",label:"浏览数",width:"100",align:"center"}),t(i,{prop:"createTime",label:"创建时间",width:"180",align:"center","show-overflow-tooltip":""}),t(i,{prop:"updateTime",label:"修改时间",width:"180",align:"center","show-overflow-tooltip":""}),t(i,{label:"操作",width:"200",align:"center",fixed:"right"},{default:o(a=>[a.row.id?(f(),x(u,{key:0,plain:"",type:"primary",size:"small",icon:m(U),onClick:L=>V(a.row)},{default:o(()=>[...e[4]||(e[4]=[s(" 编辑 ",-1)])]),_:1},8,["icon","onClick"])):C("",!0),a.row.id?(f(),x(u,{key:1,plain:"",type:"danger",size:"small",icon:m(F),onClick:L=>S(a.row)},{default:o(()=>[...e[5]||(e[5]=[s(" 删除 ",-1)])]),_:1},8,["icon","onClick"])):C("",!0)]),_:1})]),_:1},8,["data","loading"])]),_:1})])),[[N,n.value]])}}}),ne=O(X,[["__scopeId","data-v-0ca3380d"]]);export{ne as default};
