import{d as S,q as _,s as $,x as z,y as M,c as q,a as y,b as t,B as I,e as r,w as a,D as f,P as K,G as c,o as s,t as b,f as x,C,Q as F,R as G,p as m,N as k,S as P,_ as Q}from"./index-BexqmIYW.js";import{g as U,d as j}from"./index-BPiHE-iy.js";import"./request-FBsFDFsM.js";import"./utils-BLduSziy.js";const H={class:"article-manager","element-loading-background":"rgba(255, 255, 255, 1)","element-loading-text":"正在全力加载中..."},J={class:"function"},O={class:"right-controls"},W=S({__name:"index",setup(X){const w=_([]),n=_(!1),d=_({page:1,pageSize:100,searchContent:""}),p=async()=>{n.value=!0;try{const l=await U(d.value);l.code===1?w.value=l.data.rows||[]:c.error(l.message||"获取文章列表失败")}catch(l){c.error("获取文章列表失败"),console.error(l)}finally{n.value=!1}},h=()=>{d.value.page=1,p()},B=()=>{d.value.searchContent="",d.value.page=1,p()},T=()=>{k.push("/dashboard/article/edit")},V=l=>{k.push({path:"/dashboard/article/edit",query:{id:l?.id}})},A=l=>{P.confirm("确定删除该文章吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{n.value=!0;try{const e=await j(l.id);e.code===1?(c.success("删除成功"),await p()):c.error(e.message||"删除失败")}catch(e){c.error("删除失败"),console.error(e)}finally{n.value=!1}}).catch(()=>{c.info("已取消删除")})};return $(async()=>{n.value=!0,await p(),n.value=!1}),(l,e)=>{const D=r("el-input"),u=r("el-button"),i=r("el-table-column"),v=r("el-text"),g=r("RouterLink"),L=r("el-table"),N=r("el-card"),E=M("loading");return z((m(),q("div",H,[y("div",J,[y("div",O,[t(D,{modelValue:d.value.searchContent,"onUpdate:modelValue":e[0]||(e[0]=o=>d.value.searchContent=o),style:{width:"240px"},placeholder:"搜索关键词",clearable:"",onKeydown:I(h,["enter"])},null,8,["modelValue"]),t(u,{style:{margin:"0 8px"},plain:"",type:"primary",onClick:h},{default:a(()=>[...e[1]||(e[1]=[s(" 搜索 ",-1)])]),_:1}),t(u,{plain:"",onClick:B},{default:a(()=>[...e[2]||(e[2]=[s("重置",-1)])]),_:1}),t(u,{type:"success",onClick:T,icon:f(K)},{default:a(()=>[...e[3]||(e[3]=[s("新增文章",-1)])]),_:1},8,["icon"])])]),t(N,{style:{"margin-top":"16px"}},{default:a(()=>[t(L,{data:w.value,loading:n.value,stripe:"",style:{width:"100%"}},{default:a(()=>[t(i,{type:"index",label:"序号",width:"60"}),t(i,{prop:"title",label:"标题","min-width":"150","show-overflow-tooltip":""},{default:a(o=>[t(g,{to:`/article/detail?id=${o.row.id}`,style:{"text-decoration":"none"}},{default:a(()=>[t(v,null,{default:a(()=>[s(b(o.row.title),1)]),_:2},1024)]),_:2},1032,["to"])]),_:1}),t(i,{prop:"subTitle",label:"副标题","min-width":"120","show-overflow-tooltip":""},{default:a(o=>[t(g,{to:`/article/detail?id=${o.row.id}`,style:{"text-decoration":"none"}},{default:a(()=>[t(v,null,{default:a(()=>[s(b(o.row.subTitle),1)]),_:2},1024)]),_:2},1032,["to"])]),_:1}),t(i,{prop:"viewCount",label:"浏览数",width:"100",align:"center"}),t(i,{prop:"createTime",label:"创建时间",width:"180",align:"center","show-overflow-tooltip":""}),t(i,{prop:"updateTime",label:"修改时间",width:"180",align:"center","show-overflow-tooltip":""}),t(i,{label:"操作",width:"200",align:"center",fixed:"right"},{default:a(o=>[o.row.id?(m(),x(u,{key:0,plain:"",type:"primary",size:"small",icon:f(F),onClick:R=>V(o.row)},{default:a(()=>[...e[4]||(e[4]=[s(" 编辑 ",-1)])]),_:1},8,["icon","onClick"])):C("",!0),o.row.id?(m(),x(u,{key:1,plain:"",type:"danger",size:"small",icon:f(G),onClick:R=>A(o.row)},{default:a(()=>[...e[5]||(e[5]=[s(" 删除 ",-1)])]),_:1},8,["icon","onClick"])):C("",!0)]),_:1})]),_:1},8,["data","loading"])]),_:1})])),[[E,n.value]])}}}),ae=Q(W,[["__scopeId","data-v-31e066aa"]]);export{ae as default};
