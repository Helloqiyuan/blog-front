import{d as B,q as d,s as M,x as Y,y as L,c as P,a as f,b as a,B as j,e as n,w as u,G as w,o as y,p as E,_ as H}from"./index-By8O0PWA.js";import{h as K}from"./request-DjrLiPRI.js";import"./utils-kPqahFLh.js";const R=g=>K({url:"/log/page",params:g}),q={class:"log-manager","element-loading-background":"rgba(255, 255, 255, 1)","element-loading-text":"正在全力加载中..."},A={class:"function"},F={class:"right-controls"},G=B({__name:"index",setup(g){const v=d([]),r=d(!1),_=d(0),i=d(null),e=d({page:1,pageSize:20,operateNickname:"",type:-1,startTime:"",endTime:""}),p=async()=>{r.value=!0;try{const l=await R(e.value);l.code===1?(v.value=l.data.rows||[],_.value=l.data.total):w.error(l.message||"获取日志列表失败")}catch(l){w.error("获取日志列表失败"),console.error(l)}finally{r.value=!1}},m=()=>{e.value.page=1,e.value.startTime&&e.value.endTime?i.value=[e.value.startTime,e.value.endTime]:i.value=null,p()},b=()=>{e.value.operateNickname="",e.value.startTime="",e.value.endTime="",e.value.page=1,i.value=null,p()},x=()=>{e.value.page=1,p()},T=()=>{p()},C=l=>{l&&l.length===2?(e.value.startTime=l[0],e.value.endTime=l[1]):(e.value.startTime="",e.value.endTime="")};return M(async()=>{r.value=!0,await p(),r.value=!1}),(l,t)=>{const V=n("el-input"),c=n("el-option"),k=n("el-select"),z=n("el-date-picker"),h=n("el-button"),s=n("el-table-column"),N=n("el-table"),S=n("el-pagination"),D=n("el-card"),U=L("loading");return Y((E(),P("div",q,[f("div",A,[f("div",F,[a(V,{modelValue:e.value.operateNickname,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.operateNickname=o),style:{width:"200px"},placeholder:"操作人昵称",clearable:"",onKeydown:j(m,["enter"])},null,8,["modelValue"]),a(k,{modelValue:e.value.type,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.type=o),onChange:m,placeholder:"操作类型",style:{width:"120px"}},{default:u(()=>[a(c,{label:"全部日志",value:-1}),a(c,{label:"操作日志",value:0}),a(c,{label:"登录日志",value:1})]),_:1},8,["modelValue"]),a(z,{modelValue:i.value,"onUpdate:modelValue":t[2]||(t[2]=o=>i.value=o),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD HH:mm:ss",onChange:C,style:{width:"360px"}},null,8,["modelValue"]),a(h,{style:{"margin-left":"0"},plain:"",type:"primary",onClick:m},{default:u(()=>[...t[5]||(t[5]=[y(" 搜索 ",-1)])]),_:1}),a(h,{style:{"margin-left":"0"},plain:"",onClick:b},{default:u(()=>[...t[6]||(t[6]=[y("重置",-1)])]),_:1})])]),a(D,{style:{"margin-top":"16px"}},{default:u(()=>[a(N,{data:v.value,loading:r.value,stripe:"",style:{width:"100%"}},{default:u(()=>[a(s,{type:"index",label:"序号",width:"60"}),a(s,{prop:"operateNickname",label:"操作人",width:"120"}),a(s,{prop:"className",label:"类名","min-width":"150","show-overflow-tooltip":""}),a(s,{prop:"methodName",label:"方法名","min-width":"120","show-overflow-tooltip":""}),a(s,{prop:"methodParams",label:"参数","min-width":"200","show-overflow-tooltip":""}),a(s,{prop:"returnValue",label:"返回值","min-width":"200","show-overflow-tooltip":""}),a(s,{prop:"costTime",label:"耗时(ms)",width:"100",align:"center"}),a(s,{prop:"operateTime",label:"操作时间",width:"180",align:"center","show-overflow-tooltip":""})]),_:1},8,["data","loading"]),a(S,{"current-page":e.value.page,"onUpdate:currentPage":t[3]||(t[3]=o=>e.value.page=o),"page-size":e.value.pageSize,"onUpdate:pageSize":t[4]||(t[4]=o=>e.value.pageSize=o),"page-sizes":[20,30,50,100],total:_.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:x,onCurrentChange:T,style:{"margin-top":"20px","justify-content":"flex-end",display:"flex"}},null,8,["current-page","page-size","total"])]),_:1})])),[[U,r.value]])}}}),O=H(G,[["__scopeId","data-v-2737b724"]]);export{O as default};
