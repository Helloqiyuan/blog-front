import{d as M,s as _,v as $,y as R,z as S,c as q,a as y,b as t,C as I,e as r,w as a,E as f,M as K,H as c,p as s,t as b,f as x,D as C,N as F,O as H,q as m,L as k,P as O,_ as P}from"./index-D1KBpVxX.js";import{g as U,d as j}from"./index-r2jBzHea.js";import"./request-D5U2g9j6.js";import"./utils-C4zQBKTc.js";const G={class:"article-manager","element-loading-background":"rgba(255, 255, 255, 1)","element-loading-text":"正在全力加载中..."},J={class:"function"},Q={class:"right-controls"},W=M({__name:"index",setup(X){const w=_([]),n=_(!1),d=_({page:1,pageSize:100,searchContent:""}),p=async()=>{n.value=!0;try{const l=await U(d.value);l.code===1?w.value=l.data.rows||[]:c.error(l.message||"获取文章列表失败")}catch(l){c.error("获取文章列表失败"),console.error(l)}finally{n.value=!1}},v=()=>{d.value.page=1,p()},B=()=>{d.value.searchContent="",d.value.page=1,p()},T=()=>{k.push("/dashboard/article/edit")},V=l=>{k.push({path:"/dashboard/article/edit",query:{id:l?.id}})},A=l=>{O.confirm("确定删除该文章吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{n.value=!0;try{const e=await j(l.id);e.code===1?(c.success("删除成功"),await p()):c.error(e.message||"删除失败")}catch(e){c.error("删除失败"),console.error(e)}finally{n.value=!1}}).catch(()=>{c.info("已取消删除")})};return $(async()=>{n.value=!0,await p(),n.value=!1}),(l,e)=>{const L=r("el-input"),u=r("el-button"),i=r("el-table-column"),h=r("el-text"),g=r("RouterLink"),D=r("el-table"),E=r("el-card"),N=S("loading");return R((m(),q("div",G,[y("div",J,[y("div",Q,[t(L,{modelValue:d.value.searchContent,"onUpdate:modelValue":e[0]||(e[0]=o=>d.value.searchContent=o),style:{width:"240px"},placeholder:"搜索关键词",clearable:"",onKeydown:I(v,["enter"])},null,8,["modelValue"]),t(u,{style:{margin:"0 8px"},plain:"",type:"primary",onClick:v},{default:a(()=>[...e[1]||(e[1]=[s(" 搜索 ",-1)])]),_:1}),t(u,{plain:"",onClick:B},{default:a(()=>[...e[2]||(e[2]=[s("重置",-1)])]),_:1}),t(u,{type:"success",onClick:T,icon:f(K)},{default:a(()=>[...e[3]||(e[3]=[s("新增文章",-1)])]),_:1},8,["icon"])])]),t(E,{style:{"margin-top":"16px"}},{default:a(()=>[t(D,{data:w.value,loading:n.value,stripe:"",style:{width:"100%"}},{default:a(()=>[t(i,{type:"index",label:"序号",width:"60"}),t(i,{prop:"title",label:"标题","min-width":"150","show-overflow-tooltip":""},{default:a(o=>[t(g,{to:`/article/detail?id=${o.row.id}`,style:{"text-decoration":"none"}},{default:a(()=>[t(h,null,{default:a(()=>[s(b(o.row.title),1)]),_:2},1024)]),_:2},1032,["to"])]),_:1}),t(i,{prop:"subTitle",label:"副标题","min-width":"120","show-overflow-tooltip":""},{default:a(o=>[t(g,{to:`/article/detail?id=${o.row.id}`,style:{"text-decoration":"none"}},{default:a(()=>[t(h,null,{default:a(()=>[s(b(o.row.subTitle),1)]),_:2},1024)]),_:2},1032,["to"])]),_:1}),t(i,{prop:"viewCount",label:"浏览数",width:"100",align:"center"}),t(i,{prop:"createTime",label:"创建时间",width:"180",align:"center","show-overflow-tooltip":""}),t(i,{prop:"updateTime",label:"修改时间",width:"180",align:"center","show-overflow-tooltip":""}),t(i,{label:"操作",width:"200",align:"center",fixed:"right"},{default:a(o=>[o.row.id?(m(),x(u,{key:0,plain:"",type:"primary",size:"small",icon:f(F),onClick:z=>V(o.row)},{default:a(()=>[...e[4]||(e[4]=[s(" 编辑 ",-1)])]),_:1},8,["icon","onClick"])):C("",!0),o.row.id?(m(),x(u,{key:1,plain:"",type:"danger",size:"small",icon:f(H),onClick:z=>A(o.row)},{default:a(()=>[...e[5]||(e[5]=[s(" 删除 ",-1)])]),_:1},8,["icon","onClick"])):C("",!0)]),_:1})]),_:1},8,["data","loading"])]),_:1})])),[[N,n.value]])}}}),ae=P(W,[["__scopeId","data-v-c4b94d53"]]);export{ae as default};
