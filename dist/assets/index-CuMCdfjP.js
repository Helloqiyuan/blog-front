import{d as R,p as f,q as $,v as q,x as z,c as I,a as h,b as t,A as M,e as r,w as a,B as _,R as U,E as c,n as s,t as b,f as x,C,S as K,T as F,o as m,Q as k,U as O,_ as P}from"./index-26bRK5e0.js";import{A as Q,d as W}from"./index-B5oDnosC.js";import{S as j}from"./index-9ecMcTsN.js";import"./request-DEdR8Geo.js";import"./utils-D3L-YqOM.js";const G={class:"article-manager","element-loading-background":"rgba(255, 255, 255, 1)","element-loading-text":"正在全力加载中..."},H={class:"function"},J={class:"right-controls"},X=R({__name:"index",setup(Y){const w=f([]),n=f(!1),d=f({page:1,pageSize:1e3,sortType:j.VIEW_COUNT_DESC,searchContent:""}),p=async()=>{n.value=!0;try{const o=await Q(d.value);o.code===1?w.value=o.data.rows||[]:c.error(o.message||"获取文章列表失败")}catch(o){c.error("获取文章列表失败"),console.error(o)}finally{n.value=!1}},v=()=>{d.value.page=1,p()},T=()=>{d.value.searchContent="",d.value.page=1,p()},B=()=>{k.push("/dashboard/article/edit")},A=o=>{k.push({path:"/dashboard/article/edit",query:{id:o?.id}})},V=o=>{O.confirm("确定删除该文章吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{n.value=!0;try{const e=await W(o.id);e.code===1?(c.success("删除成功"),await p()):c.error(e.message||"删除失败")}catch(e){c.error("删除失败"),console.error(e)}finally{n.value=!1}}).catch(()=>{c.info("已取消删除")})};return $(async()=>{n.value=!0,await p(),n.value=!1}),(o,e)=>{const E=r("el-input"),u=r("el-button"),i=r("el-table-column"),y=r("el-text"),g=r("RouterLink"),S=r("el-table"),D=r("el-card"),N=z("loading");return q((m(),I("div",G,[h("div",H,[h("div",J,[t(E,{modelValue:d.value.searchContent,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value.searchContent=l),style:{width:"240px"},placeholder:"搜索关键词",clearable:"",onKeydown:M(v,["enter"])},null,8,["modelValue"]),t(u,{style:{"margin-left":"0"},plain:"",type:"primary",onClick:v},{default:a(()=>[...e[1]||(e[1]=[s(" 搜索 ",-1)])]),_:1}),t(u,{style:{"margin-left":"0"},plain:"",onClick:T},{default:a(()=>[...e[2]||(e[2]=[s("重置",-1)])]),_:1}),t(u,{style:{"margin-left":"0"},plain:"",type:"success",onClick:B,icon:_(U)},{default:a(()=>[...e[3]||(e[3]=[s("新增文章",-1)])]),_:1},8,["icon"])])]),t(D,{style:{"margin-top":"16px"}},{default:a(()=>[t(S,{data:w.value,loading:n.value,stripe:"",style:{width:"100%"}},{default:a(()=>[t(i,{type:"index",label:"序号",width:"60"}),t(i,{prop:"title",label:"标题","min-width":"150","show-overflow-tooltip":""},{default:a(l=>[t(g,{to:`/article/detail?id=${l.row.id}`,style:{"text-decoration":"none"}},{default:a(()=>[t(y,null,{default:a(()=>[s(b(l.row.title),1)]),_:2},1024)]),_:2},1032,["to"])]),_:1}),t(i,{prop:"subTitle",label:"副标题","min-width":"120","show-overflow-tooltip":""},{default:a(l=>[t(g,{to:`/article/detail?id=${l.row.id}`,style:{"text-decoration":"none"}},{default:a(()=>[t(y,null,{default:a(()=>[s(b(l.row.subTitle),1)]),_:2},1024)]),_:2},1032,["to"])]),_:1}),t(i,{prop:"viewCount",label:"浏览数",width:"100",align:"center"}),t(i,{prop:"createTime",label:"创建时间",width:"180",align:"center","show-overflow-tooltip":""}),t(i,{prop:"updateTime",label:"修改时间",width:"180",align:"center","show-overflow-tooltip":""}),t(i,{label:"操作",width:"200",align:"center",fixed:"right"},{default:a(l=>[l.row.id?(m(),x(u,{key:0,plain:"",type:"primary",size:"small",icon:_(K),onClick:L=>A(l.row)},{default:a(()=>[...e[4]||(e[4]=[s(" 编辑 ",-1)])]),_:1},8,["icon","onClick"])):C("",!0),l.row.id?(m(),x(u,{key:1,plain:"",type:"danger",size:"small",icon:_(F),onClick:L=>V(l.row)},{default:a(()=>[...e[5]||(e[5]=[s(" 删除 ",-1)])]),_:1},8,["icon","onClick"])):C("",!0)]),_:1})]),_:1},8,["data","loading"])]),_:1})])),[[N,n.value]])}}}),oe=P(X,[["__scopeId","data-v-544016cf"]]);export{oe as default};
