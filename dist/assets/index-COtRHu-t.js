import{d as R,q as _,s as $,x as z,y as I,c as M,a as v,b as t,B as q,e as r,w as a,C as f,O as K,G as c,o as s,t as b,f as x,D as C,P as O,Q as U,p as m,N as k,R as F,_ as G}from"./index-By8O0PWA.js";import{g as P,d as Q}from"./index-DavUGXU-.js";import{S as W}from"./index-9ecMcTsN.js";import"./request-DjrLiPRI.js";import"./utils-kPqahFLh.js";const j={class:"article-manager","element-loading-background":"rgba(255, 255, 255, 1)","element-loading-text":"正在全力加载中..."},H={class:"function"},J={class:"right-controls"},X=R({__name:"index",setup(Y){const w=_([]),n=_(!1),d=_({page:1,pageSize:1e3,sortType:W.VIEW_COUNT_DESC,searchContent:""}),p=async()=>{n.value=!0;try{const o=await P(d.value);o.code===1?w.value=o.data.rows||[]:c.error(o.message||"获取文章列表失败")}catch(o){c.error("获取文章列表失败"),console.error(o)}finally{n.value=!1}},g=()=>{d.value.page=1,p()},T=()=>{d.value.searchContent="",d.value.page=1,p()},B=()=>{k.push("/dashboard/article/edit")},V=o=>{k.push({path:"/dashboard/article/edit",query:{id:o?.id}})},A=o=>{F.confirm("确定删除该文章吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{n.value=!0;try{const e=await Q(o.id);e.code===1?(c.success("删除成功"),await p()):c.error(e.message||"删除失败")}catch(e){c.error("删除失败"),console.error(e)}finally{n.value=!1}}).catch(()=>{c.info("已取消删除")})};return $(async()=>{n.value=!0,await p(),n.value=!1}),(o,e)=>{const D=r("el-input"),u=r("el-button"),i=r("el-table-column"),y=r("el-text"),h=r("RouterLink"),E=r("el-table"),N=r("el-card"),S=I("loading");return z((m(),M("div",j,[v("div",H,[v("div",J,[t(D,{modelValue:d.value.searchContent,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value.searchContent=l),style:{width:"240px"},placeholder:"搜索关键词",clearable:"",onKeydown:q(g,["enter"])},null,8,["modelValue"]),t(u,{style:{"margin-left":"0"},plain:"",type:"primary",onClick:g},{default:a(()=>[...e[1]||(e[1]=[s(" 搜索 ",-1)])]),_:1}),t(u,{style:{"margin-left":"0"},plain:"",onClick:T},{default:a(()=>[...e[2]||(e[2]=[s("重置",-1)])]),_:1}),t(u,{style:{"margin-left":"0"},plain:"",type:"success",onClick:B,icon:f(K)},{default:a(()=>[...e[3]||(e[3]=[s("新增文章",-1)])]),_:1},8,["icon"])])]),t(N,{style:{"margin-top":"16px"}},{default:a(()=>[t(E,{data:w.value,loading:n.value,stripe:"",style:{width:"100%"}},{default:a(()=>[t(i,{type:"index",label:"序号",width:"60"}),t(i,{prop:"title",label:"标题","min-width":"150","show-overflow-tooltip":""},{default:a(l=>[t(h,{to:`/article/detail?id=${l.row.id}`,style:{"text-decoration":"none"}},{default:a(()=>[t(y,null,{default:a(()=>[s(b(l.row.title),1)]),_:2},1024)]),_:2},1032,["to"])]),_:1}),t(i,{prop:"subTitle",label:"副标题","min-width":"120","show-overflow-tooltip":""},{default:a(l=>[t(h,{to:`/article/detail?id=${l.row.id}`,style:{"text-decoration":"none"}},{default:a(()=>[t(y,null,{default:a(()=>[s(b(l.row.subTitle),1)]),_:2},1024)]),_:2},1032,["to"])]),_:1}),t(i,{prop:"viewCount",label:"浏览数",width:"100",align:"center"}),t(i,{prop:"createTime",label:"创建时间",width:"180",align:"center","show-overflow-tooltip":""}),t(i,{prop:"updateTime",label:"修改时间",width:"180",align:"center","show-overflow-tooltip":""}),t(i,{label:"操作",width:"200",align:"center",fixed:"right"},{default:a(l=>[l.row.id?(m(),x(u,{key:0,plain:"",type:"primary",size:"small",icon:f(O),onClick:L=>V(l.row)},{default:a(()=>[...e[4]||(e[4]=[s(" 编辑 ",-1)])]),_:1},8,["icon","onClick"])):C("",!0),l.row.id?(m(),x(u,{key:1,plain:"",type:"danger",size:"small",icon:f(U),onClick:L=>A(l.row)},{default:a(()=>[...e[5]||(e[5]=[s(" 删除 ",-1)])]),_:1},8,["icon","onClick"])):C("",!0)]),_:1})]),_:1},8,["data","loading"])]),_:1})])),[[S,n.value]])}}}),oe=G(X,[["__scopeId","data-v-2796859e"]]);export{oe as default};
